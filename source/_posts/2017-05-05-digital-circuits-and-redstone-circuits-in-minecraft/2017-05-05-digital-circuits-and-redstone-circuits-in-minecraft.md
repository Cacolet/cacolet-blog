---
layout: post
title: 数字电路与Minecraft中的红石电路
date: '2017-05-05 14:56:19'
categories:
  - 游戏人生
tags:
  - minecraft
  - 数字电路
  - 红石电路
reference:
  - url: 'http://minecraft-zh.gamepedia.com/%E7%BA%A2%E7%9F%B3%E7%94%B5%E8%B7%AF'
    title: 红石电路 - Minecraft Wiki
  - url: 'http://tieba.baidu.com/p/4856309625'
    title: 用minecraft实现几种基本的触发器_红石电路吧_百度贴吧
  - url: 'https://tieba.baidu.com/p/977715577'
    title: 红石电路--从入门到精通 全图文解说 （不定期更新）_minecraft吧_百度贴吧
---

Minecraft中有很多吸引人的地方，其中一个就是**红石电路**系统。有牛人就用游戏的红石电路制作了8位计算器、数字显示器等等。

前几天看到了LeetCode上面的一道题目，对，就是那道用数字电路解法的题目。看完之后心血来潮，想着用Minecraft的红石电路弄一遍，一定会非常 _COOL_ ~。:cool:

# 温习功课

好吧，数字电路的内容大多数已经忘记，所以先温习一下吧，对应在Minecraft中的表现形式也一并展示出来。

## 与或非门

先从基本的**与或非**门开始。这三种逻辑电路的真值表如下：

| A B    | 真 真 | 真 假 | 假 真 | 假 假 |
| ------ | ----- | ----- | ----- | ----- |
| A+B 或 | 真    | 真    | 真    | 假   |
| AB  与 | 真    | 假    | 假    | 假   |
| ~A  非 | 假    | 假    | 真    | 真   |

**非门**（即“反相器”）的输入与输出相反。输入为1的时候输出为0，输入为0的时候输出为1。在Mincraft中可以使用**红石火把**的阻断特性来制作。红石火把默认输出信号，当有输入信号（如拉杆）的时候，红石火把会熄灭。由此与非门的特性一致。

{% asset_img 1.png 非门 %}

**或门**的任意一个输入为1，输出就会是1。或门有两个输入端，一个输出端。根据红石火把的特性，任意一个输入端为1的时候，输出端都为0，这正好与或门的输出相反。这更像一个**或非门**，于是，在最后再加上一个非门就变成我们需要的或门了。

{% asset_img 2.png 或门 %}

**与门**只有当两个输入都为1的时候，输出才会是1。根据或门的思路，从逻辑公式推演$AB=\overline{\overline{AB}}=\overline{\overline{A}+\overline{B}}$，可能看推演公式看不出什么，但是看电路就会明白了。

{% asset_img 3.png 与门 %}

## 触发器

**触发器**是记忆电路相关的内容。上面提到的门电路的输出只与当前的输入有关，但有时候电路还需要“过去的输入”相关，也就是有记忆功能。完成这个功能的电路有**锁存器**和**触发器**。在现实生活中的电子学中，锁存器指对输入信号的某个状态产生反应的电路；触发器指对输入信号的变化产生反应的电路。

最基本的是**RS触发器**，RS触发器有三种模式：置0、置1和保持。

{% asset_img 4.png RS触发器 %}

一般常用的是精简的版本。

{% asset_img 5.png RS触发器精简版 %}

RS触发器存在禁止条件，R和S不能同时为1。这给使用者带来的不便。简单变化就是D触发器。关于D触发器有好多种实现方法，这里从[记忆电路 - Minecraft Wiki](http://minecraft-zh.gamepedia.com/%E8%AE%B0%E5%BF%86%E7%94%B5%E8%B7%AF#D.E8.A7.A6.E5.8F.91.E5.99.A8.E4.B8.8E.E9.97.A8.E6.8E.A7D.E9.94.81.E5.AD.98.E5.99.A8)上找到了一个D寄存器简化的版本。

{% asset_img D_latch_EFG.png D触发器简化图 %}

图例在这里[红石图例](http://minecraft-zh.gamepedia.com/%E7%BA%A2%E7%9F%B3%E5%9B%BE%E4%BE%8B)。根据图可以构造一个简单的D寄存器。D触发器在CP=1的作用下将D端的输入数据送给触发器，当CP=0时Q(n+1)=Q(n)不变，故常用作锁存器，因此D触发器又称为D锁存器。

{% asset_img 6.png D触发器 %}

请无视入镜的史莱姆同志。。。

需要的内容大概就这些了，下面开始开工。

# 开工

了解了一些基础内容之后，需要制作我们的三进制加法计算器了。根据[LeetCode Q137 Single Number II的数电AC方法](/2017/04/27/single-number-ii-solved-using-circult-design-and-digital-logic/)中推导的公式：

$F_1=X\overline{Z}+YZ$
$F_2=Y\overline{Z}+\overline{X}\overline{Y}Z$

分析一下，需要两个寄存器存储高位和低位，还需要一个按钮触发+1操作，最后需要一个显示的地方。这里只制作一个简单的 __半加器__ ，变换的顺序为00->01->10->00。不考虑进位的情况。

制作的步骤是，先放置输入端，然后再放置两个**D触发器**，最后将与或非门填充进去。最后的效果就是这个样子。

{% asset_img 7.png 三进制半加器 %}

没有电路精简，真是不忍直视呀。在制作的时候遇到了一些问题：

1. 电路重叠的时候，下层的红石火把很可能影响上层的电路；
2. 由于电路传输有时间间隔，很容易造成信号跳动，两个D触发器变动不一致的话很容易互相影响，出现结果不一致的情况。

对于第二个问题，没有找到一个好的解决方法，之好将两个触发器输出的延迟调高一些。从10->00的过程中出现的11的情况，最后的效果还是挺满意的吧。:joy:

{% asset_img 8.gif 效果展示 %}

就这样吧，一天又过去了。。。