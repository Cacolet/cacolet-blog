---
title: 【每日算法】千分位
date: 2021-11-06 16:58:18
tags:
    - JavaScript
    - 算法
categories:
    - 前端算法
keywords: "面试,js算法"
description: 与前端相关的算法
cover: https://img.cdn.sugarat.top/mdImg/MTY0NzY3OTY4OTgzMA==647679689830


---

## 千分位

面试中经常会问到如何给一个数加上千分位号，例如：123456789 => 123,456,789

今天我们来实现一下，用`toLocalString`方法

```js
let a = 123456789
a.toLocalString() // 123,456,789
```

但兼容性并不太满足

所以我们动手用原生js实现一下，实现步骤

- 从低位到高位，每三位数用，隔开
- 如果是负数，先将负号保存下来
- 然后一个整数部分的千分位我们就实现了

```js
function Format(num){
    let numPrefix = ''
    let numArr = ''
    let numDist = ''

    // 处理负数情况
    if (num < 0) {
        numPrefix = '-'
        numArr = String(num).slice(1).split('').reverse()
    } else {
        numArr = String(num).split('').reverse()
    }

    for (let i = 0; i < numArr.length; i++) {
        numDist += numArr[i]
        if ((i + 1) % 3 === 0 && (i + 1) < numArr.length) {
            numDist += ','
        }
    }

    return numPrefix + numDist.split('').reverse().join('')
}
console.log(Format(12334)) // 12,334
console.log(Format(-12334)) // -12,334
```

虽然实现了，但是我们满足不了有小数点的浮点数类型到千分位的转换

于是我们再改进一下

- 将添加千分位号定义为一个函数
- 然后在主函数中提取各自的部分，最后再在主函数中拼接返回

```js
function a(strArr) {
    if(!strArr.length) return ''
    let numDist = ''
    for (let i = 0; i < strArr.length; i++) {
        numDist += strArr[i]
        if ((i + 1) % 3 === 0 && (i + 1) < strArr.length) {
            numDist += ','
        }
    }
    return  numDist.split('').join('')
}

function FormatFloat(num) {
    let numPrefix = ''
    let xiaoshudian = ''
    let numArr
    let zhengshu = ''
    let xiaoshu = ''
    // 处理负数情况
    if (num < 0) {
        numPrefix = '-'
        numArr = String(num).slice(1)
    } else{
        numArr = String(num).slice(0)
    }
    if(numArr.indexOf('.') !== -1) {
        xiaoshudian = '.'
         zhengshu = numArr.slice(0,numArr.indexOf('.')).split('').reverse()
         xiaoshu = numArr.slice(numArr.indexOf('.')+1)
    }else{
        zhengshu = numArr.slice(0).split('').reverse()
    }

    return numPrefix + a(zhengshu).split('').reverse().join('')+ xiaoshudian + a(xiaoshu)
}

console.log(FormatFloat(-1223)) // -1,233
console.log(FormatFloat(-1223.5653))// -1,223.565,3
```

这样就完美实现了

